<!DOCTYPE html>
<html class=" ">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
  <title>Comodin Stock</title>
  <meta content="Comodin Stock" name="description" />
  <!-- App Icons -->
  <link rel="apple-touch-icon" sizes="57x57" href="assets/images/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="assets/images/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="assets/images/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="assets/images/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="assets/images/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="assets/images/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="assets/images/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="assets/images/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="assets/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="assets/images/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/icons/favicon-16x16.png">
  <link rel="manifest" href="assets/images/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="assets/images/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <!-- CORE CSS FRAMEWORK - START -->
  <link href="assets/css/preloader.css" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="assets/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="assets/fonts/mdi/css/materialdesignicons.min.css" type="text/css" rel="stylesheet"
    media="screen,projection" />
  <link href="assets/plugins/perfect-scrollbar/perfect-scrollbar.css" type="text/css" rel="stylesheet"
    media="screen,projection" />
  <!-- CORE CSS FRAMEWORK - END -->
  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - START -->
  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - END -->
  <!-- CORE CSS TEMPLATE - START -->
  <link href="assets/css/style.css" type="text/css" rel="stylesheet" media="screen,projection" id="main-style" />
  <!-- CORE CSS TEMPLATE - END -->
</head>
<!-- END HEAD -->
<!-- BEGIN BODY -->

<body class="  html" data-header="light" data-footer="dark" data-header_align="center" data-menu_type="left"
  data-menu="light" data-menu_icons="on" data-footer_type="left" data-site_mode="light" data-footer_menu="show"
  data-footer_menu_style="light">
  <div class="preloader-background">
    <div class="preloader-wrapper">
      <div id="preloader"></div>
    </div>
  </div>
  <!-- START navigation -->
  <nav class="fixedtop topbar navigation" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="./index.html" class=" brand-logo "><i class="mdi mdi-home-outline"
          style="color: #9575cd"></i></a>
      <!-- <ul class="right hide-on-med-and-down">
        <li><a href="#">Navbar Link</a></li>
      </ul> -->
      <!-- <ul id="nav-mobile" class="sidenav">
        <li><a href="#">Navbar Link</a></li>
      </ul> -->
      <a href="#" data-target="" class="waves-effect waves-circle navicon back-button htmlmode show-on-large "><i
          class="mdi mdi-chevron-left" data-page=""></i></a>
      <a href="#" data-target="slide-nav" class="waves-effect waves-circle navicon sidenav-trigger show-on-large"><i
          class="mdi mdi-menu"></i></a>
      <!-- <a href="#" data-target="slide-settings"
        class="waves-effect waves-circle navicon right sidenav-trigger show-on-large pulse"><i
          class="mdi mdi-tune"></i></a>
      <a href="#" data-target="" class="waves-effect waves-circle navicon right nav-site-mode show-on-large"><i
          class="mdi mdi-invert-colors mdi-transition1"></i></a> -->
      <!-- <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a> -->
    </div>
  </nav>
  <ul id="slide-nav" class="sidenav sidemenu">
    <li class="menu-close"><i class="mdi mdi-close"></i></li>
    <li class="user-wrap">
      <div class="user-view row">
        <!-- <div class="background">
        <img src="assets/images/office.jpg">
      </div> -->
        <div class="col s3 imgarea">
          <a href="#user"><img class="circle" src="assets/images/user-37.jpg"></a>
        </div>
        <div class="col s9 infoarea">
          <a href="#name"><span class="name">Cherry Smith</span></a>
          <a href="#email"><span class="email">cherrysmith@gmail.com</span></a>
        </div>
      </div>
    </li>
    <li class="menulinks">
      <ul class="collapsible">
        <!-- SIDEBAR - START -->
        <!-- MAIN MENU - START -->
        <li class="sh-wrap">
          <div class="subheader">Navigation</div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="ui-pages-home.html">
              <i class="mdi mdi-home-outline"></i>
              <span class="title">Welcome</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-apps.html">
              <i class="mdi mdi-open-in-app"></i>
              <span class="title">APPS</span><span class="badge blue-grey lighten-3 badge-rounded">NEW</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-uielements.html">
              <i class="mdi mdi-laptop"></i>
              <span class="title">UI Elements</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-utilities-components.html">
              <i class="mdi mdi-flask-outline"></i>
              <span class="title">Components</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-forms.html">
              <i class="mdi mdi-textbox"></i>
              <span class="title">Forms</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-charts.html">
              <i class="mdi mdi-chart-line"></i>
              <span class="title">Charts</span><span class="badge blue-grey lighten-3 badge-rounded">HOT</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-pages.html">
              <i class="mdi mdi-shape-outline"></i>
              <span class="title">Pages</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-access.html">
              <i class="mdi mdi-access-point"></i>
              <span class="title">Site Access</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-portfolio.html">
              <i class="mdi mdi-grid-large"></i>
              <span class="title">Portfolio</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-blogs.html">
              <i class="mdi mdi-square-edit-outline"></i>
              <span class="title">Blogs</span>
            </a>
          </div>
        </li>
        <li class="sep-wrap">
          <div class="divider"></div>
        </li>
        <li class="sh-wrap">
          <div class="subheader">Reach Us</div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect ">
            <a href="tel:+1 234 567 890">
              <i class="mdi mdi-cellphone-basic"></i>
              <span class="title">Phone</span> </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect ">
            <a href="mailto:email@example.com">
              <i class="mdi mdi-email-outline"></i>
              <span class="title">Email</span> </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect ">
            <a href="sms:+1 234 567 890">
              <i class="mdi mdi-message-text-outline"></i>
              <span class="title">Message</span> </a>
          </div>
        </li>
        <li class="sep-wrap">
          <div class="divider"></div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect "><a href="#" data-target="slide-settings" class="sidenav-trigger"><i
                class="mdi mdi-settings-outline"></i><span class="title">Settings</span> </a>
          </div>
        </li>
        <!-- MAIN MENU - END -->
        <!--  SIDEBAR - END -->
    </li>
  </ul>
  </li>
  <li class="copy-spacer"></li>
  <li class="copy-wrap">
    <div class="copyright">Stock Comodín &copy; Copyright 2022 </div>
    </ul>
    <!-- END navigation -->
  </li>
  </ul>
  <div class="container">
    <div class="section">
      <h5 class="pagetitle" id="titulo"></h5>
      <div class="divider"></div>
    </div>
  </div>
  </div>
  <div class="container">
    <div class="section">
    </div>
  </div>
  <div class="container">
    <div class="section">
      <nav class="white pad-top-15 black-text">
        <div class="nav-wrapper">
          <div class="col s12" id="ruta">

          </div>
        </div>
      </nav>
      <div class="row ">
        <div class="input-field col s12">
          <i class="mdi mdi-magnify prefix"></i>
          <textarea id="buscador" class="materialize-textarea" style="height: 42px; width:85%;"></textarea>
          <label for="buscador" class="" id="labelbuscador">Buscar...</label>
          <a href="#" onclick="pin()"><i class="mdi mdi-pin-outline prefix" id="pin"></i></a>
        </div>

      </div>



      <div class="row ">
        <div class="col s12 pad-0">
          <p>Categorías</p>

          <ul class="collection invoice-item" id="coleccionCategorias">
          </ul>
        </div>
      </div>

      <div class="row ">
        <div class="col s12 pad-0">
          <p>Componentes</p>
          <ul class="collection invoice-item" id="coleccionComponentes">
          </ul>
        </div>
      </div>

    </div>
  </div>
  <div class="backtotop">
    <a class="btn-floating btn primary-bg">
      <i class="mdi mdi-chevron-up"></i>
    </a>
  </div>
  <style>
    .fab {
      width: 50px;
      height: 50px;
      background-color: #9575CD;
      border-radius: 50%;
      box-shadow: 0 6px 10px 0 #666;
      transition: all 0.1s ease-in-out;

      font-size: 50px;
      color: white;
      text-align: center;
      line-height: 50px;

      position: fixed;
      right: 30px;
      bottom: 40px;
    }

    .fab:hover {
      box-shadow: 0 6px 14px 0 #666;
      transform: scale(1.05);
    }
  </style>

  <a href="#" id="addcompo" class="fab" onclick="addcompo()">+</a>
  <style>
    .colorgris {
      color: #455A64;
    }

    .colorgrisclaro {
      color: #9e9e9e;
    }
  </style>
  <script>

    function addcompo() {
      var url_string = window.location.href
      var url = new URL(url_string)
      var idproducto = url.searchParams.get("idproducto")
      var idconjunto = url.searchParams.get("idconjunto")
      var idcategoria = url.searchParams.get("idcategoria")
      var idpadrecat = url.searchParams.get("idpadrecat")

      window.location = './prod_compuesto_3.html?idcategoria=' + idcategoria + '&nombrecat=' + $('#titulo').text() + '&idproducto=' + idproducto + '&idconjunto=' + idconjunto + '&idpadrecat=' + idpadrecat

    }


    document.addEventListener("deviceready", getRuta, false)
    function getRuta() {
      var url_string = window.location.href;
      var url = new URL(url_string);

      var idcat = url.searchParams.get("idcategoria");
      let coleccion = ""



      var instancia1 = $.getJSON("https://stock.quattropy.com/s1/public/api/stock/getruta?idcategoria=" + idcat, function (data) {
        const lista = Object.values(data.data);
        $(lista).each(function (i, val) {
          coleccion = coleccion + '<a href="./prod_compuesto_2.html?idproducto=' + val['idprod_cat'] + '&idconjunto=' + val['idprod_cat'] + '&idcategoria=' + val['id_cat'] + '&idpadrecat=' + val['idpadre_cat'] + '" class="breadcrumb black-text">' + val['prod_nombre'] + '</a>';


          cargarLista()
        });
        var instancia1_coleccion = $(coleccion).appendTo("#ruta")

      });
    }


    document.addEventListener("deviceready", coleccionCategorias, false)
    function coleccionCategorias() {
      var url_string = window.location.href;
      var url = new URL(url_string);
      var idconjunto = url.searchParams.get("idconjunto");
      var idpadrecat = url.searchParams.get("idpadrecat");
      var idcat = url.searchParams.get("idcategoria");

      var instancia1 = $.getJSON("https://stock.quattropy.com/s1/public/api/stock/getsubcategorias?idconjunto=" + idconjunto + "&idpadrecat=" + idpadrecat + "&idcat=" + idcat, function (data) {
        let cant = 0
        $(data.data).each(function (i, val) {

          console.log('json coleccioncategorias')
          console.log(val)
          let coleccion = ""
          let foto = 'pic.jpg'
          coleccion = coleccion + "<li class='collection-item avatar' id='" + val['id_cat'] + "'><div class='item-det'><img src='https://stock.quattropy.com/s1/public/img/stock/lg/productos/" + val['prod_foto'] + "' alt='' class='circle'><span class='title'>" + val['prod_nombre'] + "</span></div><div class='secondary-content'><a href='#' onclick='delcat(" + val['id_cat'] + ")'  id='link-" + val['id_compo'] + "' class='colorgris'><i class='mdi mdi-delete-outline' id='check-" + val['id_compo'] + "'></i></a><a href='./prod_compuesto_2.html?idproducto=" + val['idprod_cat'] + "&idconjunto=" + idconjunto + "&idcategoria=" + val['id_cat'] + "&idpadrecat=" + val['idpadre_cat'] + "'><i class='mdi mdi-chevron-right' id='check-" + val['id_cat'] + "'></i></a></div></li>"
          cant++

          var instancia1_coleccion = $(coleccion).appendTo("#coleccionCategorias")
          cargarLista()
        });
      });
    }

    document.addEventListener("deviceready", coleccionComponentes, false)
    function coleccionComponentes() {
      var url_string = window.location.href
      var url = new URL(url_string)
      var idcat = url.searchParams.get("idcategoria")
      var instancia2 = $.getJSON("https://stock.quattropy.com/s1/public/api/stock/getcatcomponentes?idcat=" + idcat, function (data) {
        let cant = 0
        $(data.data).each(function (i, val) {
          //alert('json')
          console.log(val)
          $('#titulo').html(val['catnombre']);

          let coleccion = ""
          let foto = 'pic.jpg'
          coleccion = coleccion + "<li class='collection-item avatar' id='" + val['id_compo'] + "'><div class='item-det'><img src='https://stock.quattropy.com/s1/public/img/stock/lg/productos/" + val['prod_foto'] + "' alt='' class='circle'><span class='title'>" + val['prod_nombre'] + "</span></div><div class='secondary-content'><a href='#' onclick='delcompo(" + val['id_compo'] + ")'  id='link-" + val['id_compo'] + "' class='colorgris'><i class='mdi mdi-delete-outline' id='check-" + val['id_compo'] + "'></i></a><a href='#' onclick='crearCategoria(" + val['id_compo'] + ")'  id='link2-" + val['id_compo'] + "' class='colorgris'><i class='mdi mdi-animation-outline' id='check-" + val['id_compo'] + "'></i></a></div></li>"
          cant++

          var instancia2_coleccion = $(coleccion).appendTo("#coleccionComponentes")
          cargarLista()
        });
      });
    }


    function delcompo(idcompo) {
      var instancia1 = $.getJSON("https://stock.quattropy.com/s1/public/api/stock/delcompo?idcompo=" + idcompo, function (data) {
        if (data.status == 'success') {
          window.location.reload(false)
        } else {
          alert('Para eliminar el componente raíz debe eliminar la categoría.')
        }
      });
    }

    function delcat(idcat) {
      var instancia1 = $.getJSON("https://stock.quattropy.com/s1/public/api/stock/delcat?idcategoria=" + idcat, function (data) {
        if (data.status == 'success') {
          window.location.reload(false)
        } else {
          alert('Error al intentar eliminar la categoría.')
        }
      });
    }

    function crearCategoria(idcompo) {
      var instancia1 = $.getJSON("https://stock.quattropy.com/s1/public/api/stock/crearCategoria?idcompo=" + idcompo, function (data) {
        if (data.status == 'success') {
          window.location.reload(false)
        } else {
          alert('Error al intentar crear la categoria.')
        }
      });
    }



  </script>
  <!-- PWA Service Worker Code -->
  <script type="text/javascript">
    // This is the "Offline copy of pages" service worker
    // Add this below content to your HTML page, or add the js file to your page at the very top to register service worker
    // Check compatibility for the browser we're running this in
    if ("serviceWorker" in navigator) {
      if (navigator.serviceWorker.controller) {
        console.log("[PWA Builder] active service worker found, no need to register");
      } else {
        // Register the service worker
        navigator.serviceWorker
          .register("pwabuilder-sw.js", {
            scope: "./"
          })
          .then(function (reg) {
            console.log("[PWA Builder] Service worker has been registered for scope: " + reg.scope);
          });
      }
    }
    document.addEventListener('deviceready', onDeviceReady, false);
    function onDeviceReady() {
      console.log('Running cordova-' + cordova.platformId + '@' + cordova.version);
    }
    function guardar() {
      $('#guardar').attr('disable', true)
      if (localStorage.getItem('movstock1')) {
        var movstock1 = localStorage.getItem('movstock1');
        var formData = new FormData();
        formData.append("idDeposito", movstock1);
        formData.append("descripcion", $('#descripcion').val());
        formData.append("idusu", localStorage.getItem('idusu'));
        for (var value of formData.values()) {
          console.log(value);
        }
        $.ajax({
          url: 'https://stock.quattropy.com/s1/public/api/stock/movstock',
          data: formData,
          cache: false,
          contentType: false,
          processData: false,
          method: 'POST'
        })
          .done(function (data) {
            console.log(data.data)
            window.location = './mov_stock_2.html?id=' + data.data
          })
          .fail(function (data) {
            console.log(data)
            alert("Error");
          });
      } else {
        alert("Seleccione un depósito.")
      }
    }
  </script>
  <!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->
  <!-- CORE JS FRAMEWORK - START -->
  <script src="assets/js/jquery-2.2.4.min.js"></script>
  <script src="assets/js/materialize.js"></script>
  <script src="assets/plugins/perfect-scrollbar/perfect-scrollbar.min.js"></script>
  <!-- CORE JS FRAMEWORK - END -->
  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - START -->
  <script type="text/javascript">
    $("input#nombre, textarea#descripcion").characterCounter();
  </script>
  <script src="./js/localizacion.js"></script>
  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - END -->
  <script src="cordova.js"></script>
  <!-- CORE TEMPLATE JS - START -->
  <script src="assets/js/init.js"></script>
  <script src="assets/js/settings.js"></script>
  <script src="assets/js/scripts.js"></script>
  <!-- END CORE TEMPLATE JS - END -->
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
      $('.preloader-background').delay(10).fadeOut('slow');
    });
    let nombrelista = 'movstock1'
  </script>
  <script src="./js/lista.js"></script>
</body>

</html>