<!DOCTYPE html>
<html class=" ">

<head>
  <!-- 
         * @Package: Comodin Stock
         * @Author: themepassion
         * @Version: 1.0
        -->
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
  <title>Comodin Stock</title>
  <meta content="Comodin Stock" name="description" />


  <!-- App Icons -->
  <link rel="apple-touch-icon" sizes="57x57" href="assets/images/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="assets/images/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="assets/images/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="assets/images/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="assets/images/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="assets/images/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="assets/images/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="assets/images/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="assets/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="assets/images/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/icons/favicon-16x16.png">
  <link rel="manifest" href="assets/images/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="assets/images/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">






  <!-- CORE CSS FRAMEWORK - START -->
  <link href="assets/css/preloader.css" type="text/css" rel="stylesheet" media="screen,projection" />

  <link href="assets/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="assets/fonts/mdi/css/materialdesignicons.min.css" type="text/css" rel="stylesheet"
    media="screen,projection" />
  <link href="assets/plugins/perfect-scrollbar/perfect-scrollbar.css" type="text/css" rel="stylesheet"
    media="screen,projection" />


  <!-- CORE CSS FRAMEWORK - END -->

  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - START -->
  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - END -->

  <!-- CORE CSS TEMPLATE - START -->


  <link href="assets/css/style.css" type="text/css" rel="stylesheet" media="screen,projection" id="main-style" />
  <!-- CORE CSS TEMPLATE - END -->



</head>
<!-- END HEAD -->

<!-- BEGIN BODY -->


<body class="  html" data-header="light" data-footer="dark" data-header_align="center" data-menu_type="left"
  data-menu="light" data-menu_icons="on" data-footer_type="left" data-site_mode="light" data-footer_menu="show"
  data-footer_menu_style="light">
  <div class="preloader-background">
    <div class="preloader-wrapper">
      <div id="preloader"></div>
    </div>
  </div>



  <!-- START navigation -->
  <nav class="fixedtop topbar navigation" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="index.html" class=" brand-logo ">Stock</a>
      <!-- <ul class="right hide-on-med-and-down">
        <li><a href="#">Navbar Link</a></li>
      </ul> -->

      <!-- <ul id="nav-mobile" class="sidenav">
        <li><a href="#">Navbar Link</a></li>
      </ul> -->
      <a href="#" data-target="" class="waves-effect waves-circle navicon back-button htmlmode show-on-large "><i
          class="mdi mdi-chevron-left" data-page=""></i></a>

      <a href="#" data-target="slide-nav" class="waves-effect waves-circle navicon sidenav-trigger show-on-large"><i
          class="mdi mdi-menu"></i></a>



      <a href="#" data-target="slide-settings"
        class="waves-effect waves-circle navicon right sidenav-trigger show-on-large pulse"><i
          class="mdi mdi-tune"></i></a>

      <a href="#" data-target="" class="waves-effect waves-circle navicon right nav-site-mode show-on-large"><i
          class="mdi mdi-invert-colors mdi-transition1"></i></a>
      <!-- <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a> -->
    </div>
  </nav>
  <ul id="slide-nav" class="sidenav sidemenu">
    <li class="menu-close"><i class="mdi mdi-close"></i></li>
    <li class="user-wrap">
      <div class="user-view row">
        <!-- <div class="background">
        <img src="assets/images/office.jpg">
      </div> -->
        <div class="col s3 imgarea">
          <a href="#user"><img class="circle" src="assets/images/user-37.jpg"></a>
        </div>
        <div class="col s9 infoarea">
          <a href="#name"><span class="name">Cherry Smith</span></a>
          <a href="#email"><span class="email">cherrysmith@gmail.com</span></a>
        </div>
      </div>
    </li>


    <li class="menulinks">
      <ul class="collapsible">
        <!-- SIDEBAR - START -->

        <!-- MAIN MENU - START -->

        <li class="sh-wrap">
          <div class="subheader">Navigation</div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="ui-pages-home.html">
              <i class="mdi mdi-home-outline"></i>
              <span class="title">Welcome</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-apps.html">
              <i class="mdi mdi-open-in-app"></i>
              <span class="title">APPS</span><span class="badge blue-grey lighten-3 badge-rounded">NEW</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-uielements.html">
              <i class="mdi mdi-laptop"></i>
              <span class="title">UI Elements</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-utilities-components.html">
              <i class="mdi mdi-flask-outline"></i>
              <span class="title">Components</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-forms.html">
              <i class="mdi mdi-textbox"></i>
              <span class="title">Forms</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-charts.html">
              <i class="mdi mdi-chart-line"></i>
              <span class="title">Charts</span><span class="badge blue-grey lighten-3 badge-rounded">HOT</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-pages.html">
              <i class="mdi mdi-shape-outline"></i>
              <span class="title">Pages</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-access.html">
              <i class="mdi mdi-access-point"></i>
              <span class="title">Site Access</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-portfolio.html">
              <i class="mdi mdi-grid-large"></i>
              <span class="title">Portfolio</span>
            </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class=" waves-effect ">
            <a href="sub-blogs.html">
              <i class="mdi mdi-square-edit-outline"></i>
              <span class="title">Blogs</span>
            </a>
          </div>
        </li>
        <li class="sep-wrap">
          <div class="divider"></div>
        </li>
        <li class="sh-wrap">
          <div class="subheader">Reach Us</div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect ">
            <a href="tel:+1 234 567 890">
              <i class="mdi mdi-cellphone-basic"></i>
              <span class="title">Phone</span> </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect ">
            <a href="mailto:email@example.com">
              <i class="mdi mdi-email-outline"></i>
              <span class="title">Email</span> </a>
          </div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect ">
            <a href="sms:+1 234 567 890">
              <i class="mdi mdi-message-text-outline"></i>
              <span class="title">Message</span> </a>
          </div>
        </li>
        <li class="sep-wrap">
          <div class="divider"></div>
        </li>
        <li class="lvl1 ">
          <div class="waves-effect "><a href="#" data-target="slide-settings" class="sidenav-trigger"><i
                class="mdi mdi-settings-outline"></i><span class="title">Settings</span> </a>
          </div>
        </li>

        <!-- MAIN MENU - END -->



        <!--  SIDEBAR - END -->

    </li>
  </ul>
  </li>
  <li class="copy-spacer"></li>
  <li class="copy-wrap">
    <div class="copyright">Stock Comodín &copy; Copyright 2022 </div>



    </ul>
    <!-- END navigation -->


  </li>
  </ul>

  <div class="container">
    <div class="section">
      <h5 class="pagetitle">Depósito</h5>

      <div class="divider"></div>




    </div>

  </div>
  </div>







  <div class="container">
    <div class="section">










    </div>
  </div>

  <div class="container">

    <div class="section">



      <div class="row ">



        <ul class="collection invoice-item" id="coleccionProductos">

        </ul>

        <div class="spacer"></div>


      </div>

      <div class="row ">

        <div class="col s12 pad-0">
          <div class="input-field col s12">
            <select id="estado" name="estado" style="display:inline">
              <option value="" disabled>Estado de la máquina</option>
              <option value="1" selected>Operativa</option>
              <option value="2">En transito</option>
              <option value="3">En reparación</option>
              <option value="-1">Desactivada</option>
            </select>
          </div>

        </div>
      </div>
      <div class="row ">

        <div class="col s12 pad-0">
          <div class="input-field col s12">
            <textarea id="descripcion" class="materialize-textarea" data-length="240"></textarea>
            <label for="descripcion">Observación...</label>
          </div>

        </div>

      </div>

      <div class="row ">
        <div class="col s12 pad-0">

          <div class="center">
            <a class="btn-large waves-effect primary white-text" href="#" id='guardar' onclick="guardar()">Guardar</a>
          </div>

        </div>
      </div>

    </div>

  </div>






  <div class="backtotop">
    <a class="btn-floating btn primary-bg">
      <i class="mdi mdi-chevron-up"></i>
    </a>
  </div>

  <style>
    .colorgris {
      color: #455A64;
    }

    .colorgrisclaro {
      color: #9e9e9e;
    }
  </style>

  <script>

    document.addEventListener("deviceready", coleccionProductos, false);
    function coleccionProductos() {
      /*
      var url_string = window.location.href; //window.location.href
      var url = new URL(url_string);
      var id = url.searchParams.get("id");
      */

      $.getJSON("https://local.quattropy.com/comodin_stock/s1/public/api/stock/getDepositos", function (data) {

        let cant = 0;
        $(data.data).each(function (i, val) {

          let coleccion = "";
          let foto = 'pic.jpg';
          if (val['id']) {
            coleccion = coleccion + "<a href='#' onclick='seleccionardeposito(" + val['id'] + ")' id='li-" + val['id'] + "' class='colorgris'><li class='collection-item avatar' id='" + val['id'] + "'><div class='item-det'><img src='https://local.quattropy.com/comodin_stock/admin/client/comodin/multimedia/productos/" + foto + "' alt='' class='circle'><span class='title'>" + val['nombre'] + "</span><p>" + val['ciudad'] + "</p></div><div class='secondary-content'><i class='mdi mdi-pin-outline' id='check-" + val['id'] + "'></i></div></li></a>";
            cant++;

          }
          //console.log(coleccion);

          // $('#coleccionProductos').append(coleccion);
          $(coleccion).appendTo("#coleccionProductos");

          $('#cant').html('(' + cant + ')')

          if (localStorage.getItem('idDeposito') !== '') {
            $("a[id^='li-']").hide();
            let idDeposito = localStorage.getItem('idDeposito')
            let li = "#li-" + idDeposito;
            $(li).show();
            $('#check-' + idDeposito).removeClass("mdi-pin-outline colorgris"); //remover pin inactivo
            $('#check-' + idDeposito).addClass("mdi-pin colorgris"); //agregar pin activo  
          } else {
            $("a[id^='li-']").show();
          }

        });


      });


    }

    function seleccionardeposito(idDeposito) {
      if (localStorage.getItem('idDeposito') == '') {
        console.log('iddeposito esta vacio y se asigno localstorage')

        $("a[id^='li-']").hide();
        $("#li-" + idDeposito).show();
        $('#check-' + idDeposito).removeClass("mdi-pin-outline colorgrisclaro"); //remover pin inactivo
        $('#check-' + idDeposito).addClass("mdi-pin colorgris"); //agregar pin activo 

        $('#li-' + idDeposito).removeClass("colorgrisclaro");
        $('#li-' + idDeposito).addClass("colorgris");





        localStorage.setItem('idDeposito', idDeposito);

      } else
        if (idDeposito == localStorage.getItem('idDeposito')) {
          console.log('localstorage es igual a parametro se vacio localstorage')
          localStorage.setItem('idDeposito', "");
          $("a[id^='li-']").show();
          $('#check-' + idDeposito).removeClass("mdi-pin colorgris");
          $('#check-' + idDeposito).addClass("mdi-pin-outline colorgris");



        } else {
          console.log('se cargo la pagina con valor en localstorage y se cargo otro parametro')
          $("a[id^='li-']").hide();
          $("#li-" + idDeposito).show();
          $('#check-' + idDeposito).removeClass("mdi-pin-outline"); //remover pin inactivo
          $('#check-' + idDeposito).addClass("mdi-pin"); //agregar pin activo  
          localStorage.setItem('idDeposito', idDeposito);

        }



    }

    function pin() {
      if (localStorage.getItem('pin') == '' && $('#buscador').val() !== '') {
        localStorage.setItem('pin', $('#buscador').val()); //guardar el input en la base de datos
        $("#buscador").prop("disabled", true); //bloquear input
        $('#pin').removeClass("mdi-pin-outline"); //remover pin inactivo
        $("#pin").addClass("mdi-pin"); //agregar pin activo

      } else {
        localStorage.setItem('pin', '');
        $("#buscador").prop("disabled", false)
        $("#buscador").val('')
        $('#labelbuscador').show()
        $("#pin").removeClass("mdi-pin")
        $('#pin').addClass("mdi-pin-outline")

        let filtro = ''
        lista(filtro)



      }
    }
  </script>

  <!-- PWA Service Worker Code -->

  <script type="text/javascript">
    // This is the "Offline copy of pages" service worker

    // Add this below content to your HTML page, or add the js file to your page at the very top to register service worker

    // Check compatibility for the browser we're running this in
    if ("serviceWorker" in navigator) {
      if (navigator.serviceWorker.controller) {
        console.log("[PWA Builder] active service worker found, no need to register");
      } else {
        // Register the service worker
        navigator.serviceWorker
          .register("pwabuilder-sw.js", {
            scope: "./"
          })
          .then(function (reg) {
            console.log("[PWA Builder] Service worker has been registered for scope: " + reg.scope);
          });
      }
    }

    document.addEventListener('deviceready', onDeviceReady, false);

    function onDeviceReady() {

      console.log('Running cordova-' + cordova.platformId + '@' + cordova.version);
    }



    function guardar() {
      if (localStorage.getItem('idDeposito')) {
        var url_string = window.location.href; //window.location.href
        var url = new URL(url_string);
        var qr = url.searchParams.get("qr");
        var id = url.searchParams.get("id");
        var idDeposito = localStorage.getItem('idDeposito');

        var formData = new FormData();

        formData.append("id", id);
        formData.append("qr", qr);
        formData.append("idDeposito", idDeposito);

        formData.append("descripcion", $('#descripcion').val());
        
        formData.append("estado", $('#estado').val());

        formData.append("lat", localStorage.getItem('lat'));
        formData.append("lon", localStorage.getItem('lon'));
        formData.append("precision", localStorage.getItem('precision'));
        formData.append("ubicacion_hora", localStorage.getItem('ubicacion_hora'));

        for (var value of formData.values()) {
          console.log(value);
        }

        $.ajax({
          // url: 'https://local.quattropy.com/comodin_stock/app/cargardb.php',
          url: 'https://local.quattropy.com/comodin_stock/s1/public/api/stock/cargarProd',
          data: formData,
          cache: false,
          contentType: false,
          processData: false,
          method: 'POST'
        })
          .done(function (data) {
            console.log(data)

            let confirmar = window.confirm('Operacion exitosa')
            if (confirmar) {
              window.location = './index.html'
            }

          })
          .fail(function (data) {
            console.log(data)
            alert("Error");
          });
      } else {
        alert("Seleccione un depósito.")
      }
    }



  </script>


  <!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->

  <!-- CORE JS FRAMEWORK - START -->
  <script src="assets/js/jquery-2.2.4.min.js"></script>
  <script src="assets/js/materialize.js"></script>
  <script src="assets/plugins/perfect-scrollbar/perfect-scrollbar.min.js"></script>
  <!-- CORE JS FRAMEWORK - END -->


  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - START -->
  <script type="text/javascript">
    $("input#nombre, textarea#descripcion").characterCounter();
  </script>
  <script src="./js/localizacion.js"></script>
  <!-- OTHER SCRIPTS INCLUDED ON THIS PAGE - END -->

  <script src="cordova.js"></script>

  <!-- CORE TEMPLATE JS - START -->
  <script src="assets/js/init.js"></script>
  <script src="assets/js/settings.js"></script>

  <script src="assets/js/scripts.js"></script>

  <!-- END CORE TEMPLATE JS - END -->


  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
      $('.preloader-background').delay(10).fadeOut('slow');
    });
  </script>
</body>

</html>